Notes for May 14, 2024

- Review of https://docs.google.com/presentation/d/1qd8eAu9GzgWZ7gPOxSaF9FFZmjrFSgin/edit
- We made progress on use cases and security consideration
  - endless set of use cases, tried to boil it down to a smaller set based on properties
  - Yaroslav compressed the use cases further to simplify - if there's debate we can expand again
- First case - arbitrary exchange is a superset of all use cases
  - Format changes - exchange one for another
  - Cotent encoding changes
  - Crypto format change (PQC is possible here, might make this more widespread)
  - Token embedding in another token (token wrapping?) making the token context for another larger scoped token
  - Context change - changing/updating security properties
    - Audience
    - assertions
    - other context removal for privacy
  - Changing validity constraints (e.g. change audience, narrow refresh token validity timeframe)
    - George - this is not token A -> token A, but token A -> Token B
    - Yaroslav - this is about the properties, not the token itself, such as context, validity
    - George - this is like claims changes.  People are going to consider flows more broadly, might need to edit this
    - Yaroslav - refresh tokens, transaction tokens map here
    - Dean - maybe naming needs to change?
    - Yaroslav - simplicity!
    - Dmitry - what does it mean to change a token?  If we change the validity, it's a new token, but has mostly the same properties
  - Change/add subjects/domain local identities
  - Adding sender constraints
    - Dean - what happens when Token B needs a new sender constraint? Can we put some slides together that show how these are composable into different patterns?
    - Yaroslav - acknowleged
    - George - (missed some of this).  Thinking in context of augmentation.  Send in token A, get back token B with additional data.
    - Yaroslav - this is the context exchange
    - Dean - need to define context
    - George - snaps to request context, definition needed.  By context we mean "any claim identified in the token"
    - Yaroslav - agreed
    - George - we could take identity chanining and say "how do we see these properties being composed to implement the id chaining?"
  - Security considerations is still a work in progress, but we need to distill the use cases first.
    - Once we get there, we can ensure each token exchange model mitigates the identified security issues
- Dean - this looks great! What's our next step
  - Yaroslav - if we agree on these 8 use cases, then let's start on the security considerations
  - George - can we get feedback "is there an existing use case that isn't composable with these properties?"  If we missed any, they'll fall out of this work
  - George - OpenID spec exchanges 2 tokens (device/app instance + ID token) to get back a new idtoken/access token/refresh token (I missed which spec this is). George will spend time working on mapping this out
    - **future idea - how do we input multiple tokens, output 1..N tokens ** 
  - George -  what would a token exchange API look like?  How would it be shaped, broadly?  What are the use cases that map back to these 8?
  - Yaroslav - project real life scenarios to these
  - Yaroslav - be prescriptive on the API
  - Dean - yes to being prescriptive, thinking about https://ietf.slack.com/archives/C0668DF037U/p1715289069075059 how do we address the from/to formats? 
  - George - We need a way to signal to the API what the token exchange needs to accomplish.  May be very different from OAuth Token Exchange.  We should not feel constrained to build on existing mechanisms like OAuth Token Exchange.
  - **Future work - how do you authorize the caller to do a specific token exchange? George says this is orthogonal, and probably not in scope here.**
    - authZ policy is DOMAIN SPECIFIC, these are business rules.  We need to allow for it, but not mandate the HOW.
  - George - there is an instruction to the token endpoint to tell it how to handle the exchange operation(s)
  - Yaroslav - endpoint may need to be authenticated, but not all transactions may not require authN (they may be anonymous)
